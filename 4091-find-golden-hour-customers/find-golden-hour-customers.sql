# Write your MySQL query statement below
SELECT customer_id, COUNT(*) as total_orders, CEIL(SUM(CASE WHEN DATE_FORMAT(order_timestamp, '%H:%i') BETWEEN '11:00' and '14:00' OR DATE_FORMAT(order_timestamp, '%H:%i') BETWEEN '18:00' and '21:00' THEN 1 ELSE 0 END)*100/COUNT(*)) as peak_hour_percentage, ROUND(AVG(CASE WHEN order_rating IS NOT NULL THEN order_rating END),2) as average_rating FROM restaurant_orders GROUP BY customer_id HAVING COUNT(*) >= 3 AND  average_rating>= 4 AND SUM(order_rating IS NULL) / COUNT(*) < 0.5 AND peak_hour_percentage>=60 ORDER BY average_rating DESC,customer_id DESC ;